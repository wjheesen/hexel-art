(()=>{"use strict";var t={441:function(t,e,o){var r,n=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)});Object.defineProperty(e,"__esModule",{value:!0}),e.ColorBuffer=void 0;var i=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.withLength=function(t){return new this(new Uint8Array(4*t))},Object.defineProperty(e.prototype,"componentLength",{get:function(){return 4},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"r",{get:function(){return this.getComponent(0)},set:function(t){this.setComponent(0,t)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"g",{get:function(){return this.getComponent(1)},set:function(t){this.setComponent(1,t)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"b",{get:function(){return this.getComponent(2)},set:function(t){this.setComponent(2,t)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"a",{get:function(){return this.getComponent(3)},set:function(t){this.setComponent(3,t)},enumerable:!1,configurable:!0}),e.prototype.newStruct=function(t){return new e(t)},e}(o(457).StructBuffer);e.ColorBuffer=i},628:function(t,e,o){var r,n=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)});Object.defineProperty(e,"__esModule",{value:!0}),e.Mat2dBuffer=void 0;var i=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.withLength=function(t){return new this(new Float32Array(6*t))},Object.defineProperty(e.prototype,"componentLength",{get:function(){return 6},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"c1r1",{get:function(){return this.getComponent(0)},set:function(t){this.setComponent(0,t)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"c1r2",{get:function(){return this.getComponent(1)},set:function(t){this.setComponent(1,t)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"c2r1",{get:function(){return this.getComponent(2)},set:function(t){this.setComponent(2,t)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"c2r2",{get:function(){return this.getComponent(3)},set:function(t){this.setComponent(3,t)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"c3r1",{get:function(){return this.getComponent(4)},set:function(t){this.setComponent(4,t)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"c3r2",{get:function(){return this.getComponent(5)},set:function(t){this.setComponent(5,t)},enumerable:!1,configurable:!0}),e.prototype.newStruct=function(t){return new e(t)},e}(o(457).StructBuffer);e.Mat2dBuffer=i},466:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.StructBuffer=void 0;var o=function(){function t(t){this.data=t,this.dataPosition=0}return Object.defineProperty(t.prototype,"position",{get:function(){return this.dataPosition/this.componentLength},set:function(t){this.assertValidIndex(t),this.dataPosition=t*this.componentLength},enumerable:!1,configurable:!0}),t.prototype.assertValidIndex=function(t){if(t<0||t>=this.length)throw"Index "+t+" is out of bounds"},t.prototype.at=function(t){return this.position=t,this},Object.defineProperty(t.prototype,"length",{get:function(){return this.data.length/this.componentLength},enumerable:!1,configurable:!0}),t.prototype.getComponent=function(t){return this.data[this.dataPosition+t]},t.prototype.setComponent=function(t,e){return this.data[this.dataPosition+t]=e},t.prototype.get=function(t){this.assertValidIndex(t);var e=this.getStructData(t);return this.newStruct(e)},t.prototype.getStructData=function(t){var e=t*this.componentLength,o=e+this.componentLength;return this.data.subarray(e,o)},t}();e.StructBuffer=o},936:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0})},677:function(t,e,o){var r,n=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)});Object.defineProperty(e,"__esModule",{value:!0}),e.Vec2Buffer=void 0;var i=o(457),a=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.withLength=function(t){return new this(new Float32Array(2*t))},Object.defineProperty(e.prototype,"componentLength",{get:function(){return 2},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"x",{get:function(){return this.getComponent(0)},set:function(t){this.setComponent(0,t)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"y",{get:function(){return this.getComponent(1)},set:function(t){this.setComponent(1,t)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"bounds",{get:function(){return 0==this.length?i.Rect.empty():this.measureBounds(this.at(0))},enumerable:!1,configurable:!0}),e.prototype.measureBounds=function(t){for(var e=i.Rect.dimensions(t.x,t.y,0,0),o=1;o<this.length;o++)e.unionPoint(this.at(o));return e},e.prototype.newStruct=function(t){return new e(t)},e.prototype.containsPoint=function(t,e,o){void 0===e&&(e=0),void 0===o&&(o=this.length-e);for(var r=!1,n=this.at(e+o-1),i=n.x,a=n.y;o-- >0;){var s=this.at(e++),u=s.x,c=s.y;a>t.y!=c>t.y&&t.x<(u-i)*(t.y-a)/(c-a)+i&&(r=!r),i=u,a=c}return r},e}(i.StructBuffer);e.Vec2Buffer=a},635:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0})},0:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.PointerEventDetector=e.PointerEventListener=e.Pointer=void 0;var o=function(t,e,o,r,n,i,a){this.id=t,this.status=e,this.surface=o,this.position=r,this.isPrimary=n,this.isDown=i,this.activePointers=a};e.Pointer=o;var r=function(){function t(){}return t.prototype.wherePointer=function(t){return!0},t.prototype.onPointerDown=function(t){},t.prototype.onPointerMove=function(t){},t.prototype.onPointerUp=function(t){},t.prototype.onPointerCancel=function(t){},t}();e.PointerEventListener=r;var n=function(){function t(t){var e=this;this.surface=t,this.activePointers=[],this.listeners=[],this.onPointerDown=function(t){var o=e.addPointer(t,0);e.dispatchEvent(o,(function(t){return t.onPointerDown(o)}))},this.onPointerMove=function(t){var o=e.addPointer(t,1);e.dispatchEvent(o,(function(t){return t.onPointerMove(o)}))},this.onPointerUp=function(t){var o=e.addPointer(t,2);e.dispatchEvent(o,(function(t){return t.onPointerUp(o)})),e.removePointer(o)},this.onPointerCancel=function(t){var o=e.addPointer(t,2);e.dispatchEvent(o,(function(t){return t.onPointerCancel(o)})),e.removePointer(o)}}return t.prototype.startListening=function(){var t=this.surface.canvasEl;t.addEventListener("pointerdown",this.onPointerDown),t.addEventListener("pointermove",this.onPointerMove),t.addEventListener("pointerup",this.onPointerUp),t.addEventListener("pointercancel",this.onPointerCancel)},t.prototype.stopListening=function(){var t=this.surface.canvasEl;t.removeEventListener("pointerdown",this.onPointerDown),t.removeEventListener("pointermove",this.onPointerMove),t.removeEventListener("pointerup",this.onPointerUp),t.removeEventListener("pointercancel",this.onPointerCancel)},t.prototype.addListener=function(t){this.listeners.push(t)},t.prototype.dispatchEvent=function(t,e){this.listeners.filter((function(e){return e.wherePointer(t)})).forEach(e)},t.prototype.addPointer=function(t,e){var o,r=this.getPointerIndex(t.pointerId),n=0==e||!!(null===(o=this.activePointers[r])||void 0===o?void 0:o.isDown),i=this.newPointer(t,e,n);return this.surface.canvasEl.setPointerCapture(i.id),this.activePointers[r]=i,i},t.prototype.newPointer=function(t,e,r){return new o(t.pointerId,e,this.surface,this.surface.mapScreenPointToWorld(t),t.isPrimary,r,this.activePointers)},t.prototype.getPointerIndex=function(t){for(var e=0;e<this.activePointers.length;e++)if(this.activePointers[e].id==t)return e;return this.activePointers.length},t.prototype.removePointer=function(t){this.surface.canvasEl.releasePointerCapture(t.id),this.activePointers.splice(this.getPointerIndex(t.id),1)},t}();e.PointerEventDetector=n},218:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0})},501:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.WheelEventDetector=e.Wheel=void 0;var o=function(t,e,o){this.deltaY=t,this.surface=e,this.position=o};e.Wheel=o;var r=function(){function t(t){var e=this;this.surface=t,this.listeners=[],this.onWheel=function(t){t.preventDefault();var r=new o(t.deltaY,e.surface,e.surface.mapScreenPointToWorld(t));e.listeners.forEach((function(t){return t.onWheel(r)}))}}return t.prototype.startListening=function(){this.surface.canvasEl.addEventListener("wheel",this.onWheel)},t.prototype.stopListening=function(){this.surface.canvasEl.removeEventListener("wheel",this.onWheel)},t.prototype.addListener=function(t){this.listeners.push(t)},t}();e.WheelEventDetector=r},457:function(t,e,o){var r=this&&this.__createBinding||(Object.create?function(t,e,o,r){void 0===r&&(r=o),Object.defineProperty(t,r,{enumerable:!0,get:function(){return e[o]}})}:function(t,e,o,r){void 0===r&&(r=o),t[r]=e[o]}),n=this&&this.__exportStar||function(t,e){for(var o in t)"default"===o||Object.prototype.hasOwnProperty.call(e,o)||r(e,t,o)};Object.defineProperty(e,"__esModule",{value:!0}),e.Mat4=e.Vec2=e.Point=e.Mat2d=e.Ellipse=e.ColorF=e.Color=void 0,e.Color=o(497),e.ColorF=o(82),e.Ellipse=o(809),n(o(561),e),e.Mat2d=o(800),e.Point=o(71),n(o(523),e),e.Vec2=o(900),e.Mat4=o(746),n(o(466),e),n(o(441),e),n(o(628),e),n(o(936),e),n(o(677),e),n(o(635),e),n(o(385),e),n(o(908),e),n(o(350),e),n(o(96),e),n(o(584),e),n(o(512),e),n(o(913),e),n(o(387),e),n(o(218),e),n(o(393),e),n(o(138),e),n(o(749),e),n(o(0),e),n(o(501),e),n(o(9),e),n(o(343),e),n(o(357),e),n(o(807),e)},387:function(t,e,o){var r,n=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)});Object.defineProperty(e,"__esModule",{value:!0}),e.EllipseModel=void 0;var i=o(457),a=o(157),s=function(t){function e(e){return t.call(this,a.EllipseProgram.mesh,e)||this}return n(e,t),e.measureBoundaries=function(t){var e=t.c1r1,o=t.c2r1,r=t.c3r1,n=t.c1r2,a=t.c2r2,s=t.c3r2,u=e*e,c=o*o,f=n*n,p=a*a,h=e*n+o*a,l=u+c-f-p,d=.5*Math.atan2(2*h,l),y=Math.pow(Math.cos(d),2),v=Math.pow(Math.sin(d),2),b=u+c+f+p,m=Math.sqrt(l*l+4*h*h),g=.5*(b+m),P=.5*(b-m),x=Math.sqrt(g*y+P*v),_=Math.sqrt(g*v+P*y);return i.Rect.copy({left:r-x,right:r+x,top:s+_,bottom:s-_})},Object.defineProperty(e.prototype,"bounds",{get:function(){return e.measureBoundaries(this.matrix)},set:function(t){this.transform(i.Mat2d.rectToRect(this.bounds,t))},enumerable:!1,configurable:!0}),e.prototype.contains=function(t){var e=this.mapPointToModelSpace(t);return!!this.mesh.bounds.containsPoint(e)&&i.Vec2.length2(e)<=1},e}(i.PolygonModel);e.EllipseModel=s},385:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.Mesh=void 0;e.Mesh=function(t,e){this.vertices=t,this.indices=e,this.bounds=this.vertices.bounds}},512:(t,e,o)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.Model=void 0;var r=o(457),n=function(){function t(t){this.matrix=t}return Object.defineProperty(t.prototype,"center",{get:function(){return{x:this.matrix.c3r1,y:this.matrix.c3r2}},set:function(t){var e=t.x,o=t.y;this.matrix.c3r1=e,this.matrix.c3r2=o},enumerable:!1,configurable:!0}),t.prototype.mapPointToWorldSpace=function(t,e){return void 0===e&&(e={}),r.Mat2d.mapPoint(this.matrix,t,e)},t.prototype.mapPointToModelSpace=function(t,e){return void 0===e&&(e={}),r.Mat2d.mapPoint(r.Mat2d.invert(this.matrix),t,e)},t.prototype.transform=function(t){r.Mat2d.concat(t,this.matrix,this.matrix)},t.prototype.translate=function(t){this.transform(r.Mat2d.translate(t))},t.prototype.scale=function(t){this.transform(r.Mat2d.pivot(r.Mat2d.scale(t),this.center))},t.prototype.stretch=function(t){this.transform(r.Mat2d.pivot(r.Mat2d.stretch(t),this.center))},t.prototype.rotate=function(t){this.transform(r.Mat2d.pivot(r.Mat2d.rotate(t),this.center))},t}();e.Model=n},908:function(t,e,o){var r,n=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)});Object.defineProperty(e,"__esModule",{value:!0}),e.PolygonMesh=void 0;var i=o(457),a=function(t){function e(){var o=null!==t&&t.apply(this,arguments)||this;return o.miters=e.miters(o.vertices),o}return n(e,t),e.regularPolygon=function(t,o){return void 0===o&&(o=!1),new e(this.regularVertices(t,o),this.regularIndices(t))},e.regularVertices=function(t,e){void 0===e&&(e=!1);var o=i.Vec2Buffer.withLength(t),r=2*Math.PI/t,n=i.Mat2d.rotate(r),a=o.get(0);a.y=1,e&&i.Mat2d.mapPoint(i.Mat2d.rotate(r/2),a,a);for(var s=1;s<t;s++)i.Mat2d.mapPoint(n,o.get(s-1),o.at(s));return o},e.regularIndices=function(t){for(var e=new Uint16Array(3*(t-2)),o=0;o<t;o++)e[3*o+1]=o+1,e[3*o+2]=o+2;return e},e.rectangle=function(t){var o=e.rectangleVertices(t),r=e.regularIndices(4);return new e(o,r)},e.rectangleVertices=function(t){var e=i.Vec2Buffer.withLength(4);return t.topLeft(e.at(0)),t.bottomLeft(e.at(1)),t.bottomRight(e.at(2)),t.topRight(e.at(3)),e},e.star=function(t,o){var r=e.starVertices(t,o),n=e.starIndices(t);return new e(r,n)},e.starVertices=function(t,e){var o=i.Vec2Buffer.withLength(t+t),r=2*Math.PI/t,n=i.Mat2d.rotate(r);o.y=1,i.Mat2d.mapPoint(i.Mat2d.rotate(.5*r),{x:0,y:e},o.at(1));for(var a=2;a<o.length;a++)i.Mat2d.mapPoint(n,o.get(a-2),o.at(a));return o},e.starIndices=function(t){for(var e=3*(t-2),o=3*t,r=new Uint16Array(e+o),n=1,i=3,a=5,s=0;s<e;i+=2,a+=2)r[s++]=n,r[s++]=i,r[s++]=a;for(n=2*t-1,i=0,a=1,s=0;s<o;s++,n=a++,i=a++)r[s++]=n,r[s++]=i,r[s++]=a;return r},e.miters=function(t){for(var e=t.length,o=e-1,r=i.Vec2Buffer.withLength(e),n=i.Vec2.copy(t.at(o)),a=i.Vec2.copy(t.at(0)),s=i.Vec2.fromPointToPoint(n,a),u={},c=0;c<e;c++)i.Vec2.copy(a,n),i.Vec2.copy(t.at((c+1)%o),a),i.Vec2.fromPointToPoint(n,a,u),i.Vec2.miter(s,u,1,3,r.at(c)),i.Vec2.copy(u,s);return r},e.prototype.containsPoint=function(t){return this.vertices.containsPoint(t)},e}(i.Mesh);e.PolygonMesh=a},913:function(t,e,o){var r,n=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)});Object.defineProperty(e,"__esModule",{value:!0}),e.PolygonModel=void 0;var i=o(457),a=function(t){function e(e,o){void 0===o&&(o=i.Mat2d.identity());var r=t.call(this,o)||this;return r.mesh=e,r}return n(e,t),Object.defineProperty(e.prototype,"bounds",{get:function(){for(var t=this.mesh.vertices,e=this.mapPointToWorldSpace(t.at(0)),o=e.x,r=e.y,n=i.Rect.dimensions(o,r,0,0),a=1;a<t.length;a++)n.unionPoint(this.mapPointToWorldSpace(t.at(a)));return n},set:function(t){this.transform(i.Mat2d.rectToRect(this.bounds,t))},enumerable:!1,configurable:!0}),e.prototype.vertexAt=function(t,e){return void 0===e&&(e={}),this.mapPointToWorldSpace(this.mesh.vertices.at(t),e)},e.prototype.containsPoint=function(t){return this.mesh.containsPoint(this.mapPointToModelSpace(t))},e.prototype.scaleToFit=function(t,e){void 0===e&&(e=2),i.Mat2d.rectToRect(this.mesh.bounds,t,e,this.matrix)},e.prototype.stretchAcross=function(t){var e=t.p1,o=t.p2,r=this.mesh.bounds,n=r.centerX,a=i.Vec2.fromPointToPoint({x:n,y:r.top},e),s=i.Mat2d.translate(a,this.matrix),u=i.Mat2d.mapPoint(s,{x:n,y:r.bottom}),c=i.Mat2d.stretchRotateToPoint(u,o,e);this.transform(c)},e}(i.Model);e.PolygonModel=a},157:function(t,e,o){var r,n=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)});Object.defineProperty(e,"__esModule",{value:!0}),e.EllipseProgram=void 0;var i=o(457),a=o(524),s=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.create=function(t){var o=new e;return o.location=t.createProgramFromSources(a.vertex,a.fragment),o.uniforms=t.getUniformLocationMap(o.location,a.uniformRenaming),o.attribs=t.getAttributeLocationMap(o.location,a.attributeRenaming),o.positionBuffer=t.createArrayBuffer(e.mesh.vertices.data),o.matrixBuffer=t.createBuffer(),o},e.prototype.onAttach=function(t){var e=t.gl,o=t.angleExt,r=this.attribs.model,n=r+1,i=this.attribs.offset;e.enable(e.BLEND),e.bindBuffer(e.ARRAY_BUFFER,this.positionBuffer),e.enableVertexAttribArray(this.attribs.position),e.vertexAttribPointer(this.attribs.position,2,e.FLOAT,!1,0,0),e.bindBuffer(e.ARRAY_BUFFER,this.matrixBuffer),e.enableVertexAttribArray(r),e.enableVertexAttribArray(n),e.enableVertexAttribArray(i),o.vertexAttribDivisorANGLE(r,1),o.vertexAttribDivisorANGLE(n,1),o.vertexAttribDivisorANGLE(i,1)},e.prototype.onDetach=function(t){var e=t.angleExt,o=this.attribs.model,r=o+1,n=this.attribs.offset;e.vertexAttribDivisorANGLE(o,0),e.vertexAttribDivisorANGLE(r,0),e.vertexAttribDivisorANGLE(n,0)},e.prototype.draw=function(t,e){var o=t.gl,r=t.angleExt,n=t.camera;t.useProgram(this),this.loadProjection(o,n.matrix),this.loadMatrices(o,e),this.loadFillColor(o),this.loadStrokeColor(o),this.loadLineWidth(o),r.drawArraysInstancedANGLE(o.TRIANGLE_FAN,0,4,e.length)},e.prototype.loadProjection=function(t,e){t.uniformMatrix4fv(this.uniforms.projection,!1,e)},e.prototype.loadMatrices=function(t,e){var o=this.attribs.model,r=o+1,n=this.attribs.offset;t.bufferData(t.ARRAY_BUFFER,e.data,t.DYNAMIC_DRAW),t.vertexAttribPointer(o,2,t.FLOAT,!1,24,0),t.vertexAttribPointer(r,2,t.FLOAT,!1,24,8),t.vertexAttribPointer(n,2,t.FLOAT,!1,24,16)},e.prototype.loadFillColor=function(t){t.uniform4fv(this.uniforms.fillColor,this.fillColor.data)},e.prototype.loadStrokeColor=function(t){t.uniform4fv(this.uniforms.strokeColor,this.strokeColor.data)},e.prototype.loadLineWidth=function(t){t.uniform1f(this.uniforms.lineWidth,this.lineWidth)},e.mesh=i.PolygonMesh.rectangle(i.Rect.dimensions(-1,1,2,2)),e}(i.Program);e.EllipseProgram=s},524:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.uniformRenaming=e.attributeRenaming=e.fragment=e.vertex=void 0,e.vertex="precision mediump float;uniform mat4 z;uniform float s;attribute mat2 c;attribute vec2 v,h;varying vec2 f,e;mat2 i(float a){float b=sin(a),d=cos(a);return mat2(d,b,-b,d);}void main(){float j=c[0].x,k=c[1].x,l=c[0].y,m=c[1].y,a=(j+m)/2.,b=(j-m)/2.,d=(l+k)/2.,g=(l-k)/2.,n=sqrt(a*a+g*g),o=sqrt(b*b+d*d),A=n+o,p=n-o,q=atan(d,b),r=atan(g,a),w=(r-q)/2.,x=(r+q)/2.;mat2 t=i(x),u=i(w);t[1]*=sign(p),p=abs(p);vec2 y=t*(s*(u*h)),B=c*h+v+y;gl_Position=z*vec4(B,1.,1.),e=u*h,f=e*(1.+s/vec2(A,p));}",e.fragment="precision mediump float;uniform vec4 C,D;varying vec2 f,e;void main(){bool a=dot(f,f)<1.,b=dot(e,e)<1.;gl_FragColor=a?C:b?D:vec4(0.);}",e.attributeRenaming={model:"c",offset:"v",position:"h"},e.uniformRenaming={projection:"z",lineWidth:"s",fillColor:"C",strokeColor:"D"}},584:function(t,e,o){var r,n=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)});Object.defineProperty(e,"__esModule",{value:!0}),e.FillProgram=void 0;var i=o(457),a=o(549),s=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.create=function(t,o){var r=new e;return r.location=t.createProgramFromSources(a.vertex,a.fragment),r.uniforms=t.getUniformLocationMap(r.location,a.uniformRenaming),r.attribs=t.getAttributeLocationMap(r.location,a.attributeRenaming),r.indexBuffer=t.createIndexBuffer(o),r.positionBuffer=t.createVertexBuffer(o),r.matrixBuffer=t.createBuffer(),r.dynamicBuffer=t.createBuffer(),r},e.prototype.onAttach=function(t){var e=t.gl,o=t.angleExt,r=this.attribs.model,n=r+1,i=this.attribs.offset;e.enable(e.BLEND),e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,this.indexBuffer),e.enableVertexAttribArray(this.attribs.position),e.enableVertexAttribArray(r),e.enableVertexAttribArray(n),e.enableVertexAttribArray(i),o.vertexAttribDivisorANGLE(r,1),o.vertexAttribDivisorANGLE(n,1),o.vertexAttribDivisorANGLE(i,1)},e.prototype.onDetach=function(t){var e=t.angleExt,o=this.attribs.model,r=o+1,n=this.attribs.offset;e.vertexAttribDivisorANGLE(o,0),e.vertexAttribDivisorANGLE(r,0),e.vertexAttribDivisorANGLE(n,0)},e.prototype.draw=function(t,e,o){var r=t.gl,n=t.angleExt;t.useProgram(this),this.loadProjection(r,t.camera.matrix),this.loadColor(r),this.loadVertices(r,e),this.loadMatrices(r,o),e.indices?n.drawElementsInstancedANGLE(r.TRIANGLES,e.indices.length,r.UNSIGNED_SHORT,e.indexBufferOffset,o.length):n.drawArraysInstancedANGLE(r.TRIANGLES,0,e.vertices.length,o.length)},e.prototype.drawTriangleStrip=function(t,e,o){var r=t.gl,n=t.angleExt;t.useProgram(this),this.loadProjection(r,t.camera.matrix),this.loadColor(r),this.loadLineVertices(r,e),this.loadMatrices(r,o),n.drawArraysInstancedANGLE(r.TRIANGLE_STRIP,0,e.length,o.length)},e.prototype.loadProjection=function(t,e){t.uniformMatrix4fv(this.uniforms.projection,!1,e)},e.prototype.loadColor=function(t){t.uniform4fv(this.uniforms.color,this.color.data)},e.prototype.loadVertices=function(t,e){t.bindBuffer(t.ARRAY_BUFFER,this.positionBuffer),t.vertexAttribPointer(this.attribs.position,2,t.FLOAT,!1,0,e.vertexBufferOffset)},e.prototype.loadLineVertices=function(t,e){t.bindBuffer(t.ARRAY_BUFFER,this.dynamicBuffer),t.bufferData(t.ARRAY_BUFFER,e.data,t.DYNAMIC_DRAW),t.vertexAttribPointer(this.attribs.position,2,t.FLOAT,!1,0,0)},e.prototype.loadMatrices=function(t,e){var o=this.attribs.model,r=o+1,n=this.attribs.offset;t.bindBuffer(t.ARRAY_BUFFER,this.matrixBuffer),t.bufferData(t.ARRAY_BUFFER,e.data,t.DYNAMIC_DRAW),t.vertexAttribPointer(o,2,t.FLOAT,!1,24,0),t.vertexAttribPointer(r,2,t.FLOAT,!1,24,8),t.vertexAttribPointer(n,2,t.FLOAT,!1,24,16)},e}(i.Program);e.FillProgram=s},549:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.uniformRenaming=e.attributeRenaming=e.fragment=e.vertex=void 0,e.vertex="precision mediump float;uniform mat4 d;attribute mat2 a;attribute vec2 b,c;void main(){vec2 e=a*c+b;gl_Position=d*vec4(e,1.,1.);}",e.fragment="precision mediump float;uniform vec4 f;void main(){gl_FragColor=f;}",e.attributeRenaming={model:"a",offset:"b",position:"c"},e.uniformRenaming={projection:"d",color:"f"}},350:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.ProgramUtil=void 0;var o=function(){function t(t){this.gl=t}return t.prototype.createBuffer=function(){return this.gl.createBuffer()},t.prototype.createArrayBuffer=function(t,e){void 0===e&&(e=this.gl.STATIC_DRAW);var o=this.gl,r=o.createBuffer();return o.bindBuffer(o.ARRAY_BUFFER,r),o.bufferData(o.ARRAY_BUFFER,t,e),r},t.prototype.createElementBuffer=function(t,e){void 0===e&&(e=this.gl.STATIC_DRAW);var o=this.gl,r=o.createBuffer();return o.bindBuffer(o.ELEMENT_ARRAY_BUFFER,r),o.bufferData(o.ELEMENT_ARRAY_BUFFER,t,e),r},t.prototype.createVertexBuffer=function(t){for(var e=this.gl,o=this.sizeOfVertexBuffer(t),r=this.createArrayBuffer(o,e.STATIC_DRAW),n=0,i=0,a=t;i<a.length;i++){var s=a[i],u=s.vertices.data;e.bufferSubData(e.ARRAY_BUFFER,n,u),s.vertexBufferOffset=n,n+=u.byteLength}return r},t.prototype.sizeOfVertexBuffer=function(t){return t.reduce((function(t,e){return t+e.vertices.data.byteLength}),0)},t.prototype.createIndexBuffer=function(t){for(var e=this.gl,o=this.sizeOfIndexBuffer(t),r=this.createElementBuffer(o,e.STATIC_DRAW),n=0,i=0,a=t;i<a.length;i++){var s=a[i],u=s.indices;e.bufferSubData(e.ELEMENT_ARRAY_BUFFER,n,u),s.indexBufferOffset=n,n+=u.byteLength}return r},t.prototype.sizeOfIndexBuffer=function(t){return t.reduce((function(t,e){return t+e.indices.byteLength}),0)},t.prototype.createMiterBuffer=function(t){for(var e,o=this.gl,r=this.sizeOfStrokeVertexBuffer(t),n=this.createArrayBuffer(r),i=0,a=0,s=t;a<s.length;a++){var u=s[a];u.miterBufferOffset=i,i+=u.vertices.data.byteLength,e=u.miters.data,o.bufferSubData(o.ARRAY_BUFFER,i,e),i+=e.byteLength}return n},t.prototype.createStrokeIndexBuffer=function(t){for(var e=this.lengthOfStrokeIndexArray(t),o=new Uint16Array(e),r=0,n=0,i=t;n<i.length;n++){var a=i[n],s=a.vertices.length;a.strokeIndexCount=2*(s+1),a.strokeIndexBufferOffset=2*r;for(var u=0;u<s;u++)o[r++]=u+s,o[r++]=u;o[r++]=s,o[r++]=0}return this.createElementBuffer(o,this.gl.STATIC_DRAW)},t.prototype.lengthOfStrokeIndexArray=function(t){return t.reduce((function(t,e){return t+2*(e.vertices.length+1)}),0)},t.prototype.createStrokeVertexBuffer=function(t){for(var e=this.gl,o=this.sizeOfStrokeVertexBuffer(t),r=this.createArrayBuffer(o),n=0,i=0,a=t;i<a.length;i++){var s=a[i],u=s.vertices.data;e.bufferSubData(e.ARRAY_BUFFER,n,u),s.strokeVertexBufferOffset=n,n+=u.byteLength,e.bufferSubData(e.ARRAY_BUFFER,n,u),n+=u.byteLength}return r},t.prototype.sizeOfStrokeVertexBuffer=function(t){return this.sizeOfStrokeVertexBuffer(t)+t.reduce((function(t,e){return t+e.miters.data.byteLength}),0)},t.prototype.createProgramFromSources=function(t,e){var o=this.compileShader(t,this.gl.VERTEX_SHADER),r=this.compileShader(e,this.gl.FRAGMENT_SHADER);return this.createProgramFromShaders(o,r)},t.prototype.createProgramFromShaders=function(t,e){var o=this.gl,r=o.createProgram();if(o.attachShader(r,t),o.attachShader(r,e),o.linkProgram(r),!o.getProgramParameter(r,o.LINK_STATUS))throw"program filed to link:"+o.getProgramInfoLog(r);return r},t.prototype.compileShader=function(t,e){var o=this.gl,r=o.createShader(e);if(o.shaderSource(r,t),o.compileShader(r),!o.getShaderParameter(r,o.COMPILE_STATUS))throw"could not compile shader:"+o.getShaderInfoLog(r);return r},t.prototype.getUniformLocationMap=function(t,e){var o=this.gl,r={};if(e)for(var n in e)r[n]=o.getUniformLocation(t,e[n]);else for(var i=o.getProgramParameter(t,o.ACTIVE_UNIFORMS),a=0;a<i;a++){var s=o.getActiveUniform(t,a).name;r[s]=o.getUniformLocation(t,s)}return r},t.prototype.getAttributeLocationMap=function(t,e){var o=this.gl,r={};if(e)for(var n in e)r[n]=o.getAttribLocation(t,e[n]);else for(var i=o.getProgramParameter(t,o.ACTIVE_ATTRIBUTES),a=0;a<i;a++){var s=o.getActiveAttrib(t,a).name;r[s]=o.getAttribLocation(t,s)}return r},t}();e.ProgramUtil=o},96:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.Program=void 0;e.Program=function(){}},393:(t,e,o)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.Camera=void 0;var r=o(457),n=function(){function t(t,e,o){this.world=t,this.minZoom=e,this.maxZoom=o,this.matrix=new Float32Array(16),this.view=r.Rect.copy(this.world),this.position={x:0,y:0},this.zoom=1}return t.prototype.setViewport=function(t,e){r.Rect.copy(this.world,this.view);var o=t/e,n=this.world.aspect;n<o?this.view.scaleX(o/n):this.view.scaleY(n/o),this.view.stretch(1/this.zoom),this.view.offset(this.position),this.updateMatrix()},t.prototype.offset=function(t){var e=r.Vec2.add(t,this.position),o=(this.zoom-this.minZoom)/this.zoom,n=r.Mat2d.mapRect(r.Mat2d.stretch(o),this.world),i=r.Rect.copy(n);i.offset(r.Vec2.rotate180(n.center()));var a=r.Vec2.copy(t);return e.x<i.left?a.x=i.left-this.position.x:e.x>i.right&&(a.x=i.right-this.position.x),e.y<i.bottom?a.y=i.bottom-this.position.y:e.y>i.top&&(a.y=i.top-this.position.y),this.view.offset(a),r.Vec2.add(this.position,a,this.position),this.updateMatrix(),a},t.prototype.zoomIn=function(t){var e,o=this.zoom*t;return o<this.minZoom?(e=this.minZoom/this.zoom,this.zoom=this.minZoom):o>this.maxZoom?(e=this.maxZoom/this.zoom,this.zoom=this.maxZoom):(e=t,this.zoom=o),this.view.stretch(1/e),this.updateMatrix(),e},t.prototype.zoomToPoint=function(t,e){var o=this.view,n=(e.x-o.left)/o.width,i=(e.y-o.bottom)/o.height,a=this.zoomIn(t),s={x:o.left+n*o.width,y:o.bottom+i*o.height},u=r.Vec2.fromPointToPoint(s,e);return{scale:a,offset:this.offset(u)}},t.prototype.updateMatrix=function(){r.Mat4.ortho(this.view,.1,10,this.matrix)},t}();e.Camera=n},138:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.Renderer=void 0;var o=function(){function t(t,e){this.gl=t,this.camera=e,this.angleExt=this.gl.getExtension("ANGLE_instanced_arrays")}return t.prototype.onSurfaceChange=function(t,e){this.gl.viewport(0,0,t,e),this.camera.setViewport(t,e)},t.prototype.useProgram=function(t){this.currentProgram!==t&&this.attachProgram(t)},t.prototype.attachProgram=function(t){this.gl.useProgram(t.location),this.currentProgram&&this.currentProgram.onDetach(this),t.onAttach(this),this.currentProgram=t},t}();e.Renderer=o},749:(t,e,o)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.Surface=void 0;var r=o(457),n=o(0),i=o(501),a=function(){function t(t,e,o){var r=this;this.canvasEl=t,this.renderer=e,this.scene=o,this.clientRect=this.canvasEl.getBoundingClientRect(),this.hasRenderRequest=!1,this.checkRender=function(){r.resize(),r.onAnimationFrame(),requestAnimationFrame(r.checkRender)}}return t.prototype.startRenderLoop=function(){this.requestRender(),this.checkRender()},t.prototype.requestRender=function(){this.hasRenderRequest=!0},t.prototype.onAnimationFrame=function(){this.hasRenderRequest&&(this.scene.draw(this.renderer),this.hasRenderRequest=!1)},t.prototype.resize=function(t,e){void 0===t&&(t=this.canvasEl.clientWidth),void 0===e&&(e=this.canvasEl.clientHeight),this.canvasEl.width===t&&this.canvasEl.height===e||(this.canvasEl.width=t,this.canvasEl.height=e,this.clientRect=this.canvasEl.getBoundingClientRect(),this.renderer.onSurfaceChange(t,e),this.requestRender())},t.prototype.startDetectingPointerEvents=function(){var t=new n.PointerEventDetector(this);return t.startListening(),t},t.prototype.startDetectingWheelEvents=function(){var t=new i.WheelEventDetector(this);return t.startListening(),t},t.prototype.pan=function(t){var e=this.renderer.camera.offset(t);return 0!=r.Vec2.length2(e)&&this.requestRender(),e},t.prototype.zoomIn=function(t){1!=this.renderer.camera.zoomIn(t)&&this.requestRender()},t.prototype.zoomOut=function(t){this.zoomIn(1/t)},t.prototype.zoomToPoint=function(t,e){var o=this.renderer.camera.zoomToPoint(t,e);return 1==o.scale&&0==r.Vec2.length2(o.offset)||this.requestRender(),o},t.prototype.mapScreenPointToCanvas=function(t){return{x:t.clientX-this.clientRect.left,y:t.clientY-this.clientRect.top}},t.prototype.mapScreenPointToNdc=function(t){return this.mapCanvasPointToNdc(this.mapScreenPointToCanvas(t))},t.prototype.mapScreenPointToWorld=function(t){return this.mapNdcToWorld(this.mapScreenPointToNdc(t))},t.prototype.mapCanvasPointToNdc=function(t){var e=this.clientRect,o=e.width,r=e.height;return{x:t.x/o,y:(r-t.y)/r}},t.prototype.mapNdcToWorld=function(t){var e=this.renderer.camera.view;return{x:e.left+t.x*e.width,y:e.bottom+t.y*e.height}},t}();e.Surface=a},497:(t,e,o)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.equals=e.isTransparent=e.isOpaque=e.blend=e.random=e.toArgbString=e.fromArgbString=e.toRgbaInt=e.fromRgbInt=e.fromRgbaInt=e.copy=void 0;var r=o(768);function n(t,e){return void 0===e&&(e={}),e.r=t>>24&255,e.g=t>>16&255,e.b=t>>8&255,e.a=t>>0&255,e}e.copy=function(t,e){return void 0===e&&(e={}),e.r=t.r,e.g=t.g,e.b=t.b,e.a=t.a,e},e.fromRgbaInt=n,e.fromRgbInt=function(t,e){return void 0===e&&(e={}),n(t<<8|255,e)},e.toRgbaInt=function(t){return(t.r<<24|t.g<<16|t.b<<8|t.a<<0)>>>0},e.fromArgbString=function(t,e){void 0===e&&(e={});var o="#"==t[0]?1:0;return e.a=parseInt(t.substr(o,2),16),e.r=parseInt(t.substr(o+2,2),16),e.g=parseInt(t.substr(o+4,2),16),e.b=parseInt(t.substr(o+6,2),16),e},e.toArgbString=function(t){return"#"+r.pad(t.a.toString(16))+r.pad(t.r.toString(16))+r.pad(t.g.toString(16))+r.pad(t.b.toString(16))},e.random=function(t){return void 0===t&&(t={}),t.r=r.randomByte(),t.g=r.randomByte(),t.b=r.randomByte(),t.a=void 0===t.a?255:t.a,t},e.blend=function(t,e,o){void 0===o&&(o={});var r=t.a+1,n=256-t.a;return o.r=r*t.r+n*e.r>>8,o.g=r*t.g+n*e.g>>8,o.b=r*t.b+n*e.b>>8,o.a=e.a,o},e.isOpaque=function(t){return 255===t.a},e.isTransparent=function(t){return 0===t.a},e.equals=function(t,e){return t.r==e.r&&t.g==e.g&&t.b==e.b&&t.a==e.a}},82:(t,e,o)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.premultiplyAlpha=e.isOpaque=e.random=e.toColor=e.fromColor=e.equals=e.isTransparent=e.copy=void 0;var r=o(497);Object.defineProperty(e,"copy",{enumerable:!0,get:function(){return r.copy}}),Object.defineProperty(e,"isTransparent",{enumerable:!0,get:function(){return r.isTransparent}}),e.equals=function(t,e,o){return void 0===o&&(o=0),Math.abs(t.r-e.r)<=o&&Math.abs(t.g-e.g)<=o&&Math.abs(t.b-e.b)<=o},e.fromColor=function(t,e){return void 0===e&&(e={}),e.r=t.r/255,e.g=t.g/255,e.b=t.b/255,e.a=t.a/255,e},e.toColor=function(t,e){return void 0===e&&(e={}),e.r=255*t.r>>0,e.g=255*t.g>>0,e.b=255*t.b>>0,e.a=255*t.a>>0,e},e.random=function(t){return void 0===t&&(t={}),t.r=Math.random(),t.g=Math.random(),t.b=Math.random(),t.a=void 0===t.a?1:t.a,t},e.isOpaque=function(t){return 1===t.a},e.premultiplyAlpha=function(t,e){return void 0===e&&(e={}),e.r=t.r*t.a,e.g=t.g*t.a,e.b=t.b*t.a,e.a=1,e}},809:(t,e,o)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.equals=e.containsPoint=e.fromRect=e.circle=e.copy=void 0;var r=o(457);function n(t,e){return void 0===e&&(e={}),e.rx=t.rx,e.ry=t.ry,e.c=r.Point.copy(t.c,e.c),e}e.copy=n,e.circle=function(t,e,o){return void 0===o&&(o={}),n({rx:t,ry:t,c:e},o)},e.fromRect=function(t,e){return void 0===e&&(e={}),n({rx:t.width/2,ry:t.height/2,c:t.center()},e)},e.containsPoint=function(t,e){var o=r.Vec2.fromPointToPoint(e,t.c),n=o.x/t.rx,i=o.y/t.ry;return n*n+i*i<=1},e.equals=function(t,e,o){return void 0===o&&(o=0),Math.abs(t.rx-e.rx)<=o&&Math.abs(t.ry-e.ry)<=o&&r.Point.equals(t.c,e.c,o)}},561:(t,e,o)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.LineSegment=void 0;var r=o(457),n=function(){function t(t,e){this.p1=t,this.p2=e}return Object.defineProperty(t.prototype,"midpoint",{get:function(){return r.Point.midpoint(this.p1,this.p2)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"length",{get:function(){return r.Point.distance(this.p1,this.p2)},enumerable:!1,configurable:!0}),t.prototype.containsPoint=function(t,e){void 0===e&&(e=0);var o=this.p1,n=r.Vec2.fromPointToPoint(this.p1,this.p2),i=-1,a=r.Vec2.fromPointToPoint(o,t),s=r.Vec2.length2(n);if(0!=s&&(i=r.Vec2.dot(n,a)/s),i<0||i>1)return!1;var u=r.Vec2.add(o,r.Vec2.multiply(n,i));return r.Point.distance2(u,t)<=e*e},t.prototype.copy=function(){return new t(r.Point.copy(this.p1),r.Point.copy(this.p2))},t.prototype.equals=function(t,e){return void 0===e&&(e=0),r.Point.equals(this.p1,t.p1,e)&&r.Point.equals(this.p2,t.p2,e)},t}();e.LineSegment=n},800:(t,e,o)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.equals=e.mapRect=e.mapPoint=e.rectToRect=e.sinCos=e.stretchRotateToPoint=e.rotate=e.stretch=e.scaleToPoint=e.scale=e.translate=e.identity=e.conjugate=e.pivot=e.concat=e.determinant=e.invert=e.copy=void 0;var r=o(457);function n(t,e){void 0===e&&(e={});var o=i(t),r=t.c1r1,n=t.c2r1,a=t.c3r1,s=t.c1r2,u=t.c2r2,c=t.c3r2;return e.c1r1=u/o,e.c2r1=-n/o,e.c3r1=(n*c-a*u)/o,e.c1r2=-s/o,e.c2r2=r/o,e.c3r2=(s*a-r*c)/o,e}function i(t){return t.c1r1*t.c2r2-t.c2r1*t.c1r2}function a(t,e,o){void 0===o&&(o={});var r=t.c1r1*e.c1r1+t.c2r1*e.c1r2,n=t.c1r1*e.c2r1+t.c2r1*e.c2r2,i=t.c1r1*e.c3r1+t.c2r1*e.c3r2+t.c3r1,a=t.c1r2*e.c1r1+t.c2r2*e.c1r2,s=t.c1r2*e.c2r1+t.c2r2*e.c2r2,u=t.c1r2*e.c3r1+t.c2r2*e.c3r2+t.c3r2;return o.c1r1=r,o.c2r1=n,o.c3r1=i,o.c1r2=a,o.c2r2=s,o.c3r2=u,o}function s(t,e,o){return void 0===o&&(o={}),u(t,c(e),o)}function u(t,e,o){return void 0===o&&(o={}),a(e,a(t,n(e)),o)}function c(t,e){var o=t.x,r=t.y;return void 0===e&&(e={}),e.c1r1=1,e.c2r1=0,e.c3r1=o,e.c1r2=0,e.c2r2=1,e.c3r2=r,e}function f(t,e){var o=t.x,r=t.y;return void 0===e&&(e={}),e.c1r1=o,e.c2r1=0,e.c3r1=0,e.c1r2=0,e.c2r2=r,e.c3r2=0,e}function p(t,e){return void 0===e&&(e={}),f({x:t,y:t},e)}function h(t,e,o){return void 0===o&&(o={}),o.c1r1=e,o.c2r1=-t,o.c3r1=0,o.c1r2=t,o.c2r2=e,o.c3r2=0,o}function l(t,e){switch(e){case 0:return t.center();case 1:return t.bottomRight();default:return t.topLeft()}}function d(t,e,o){var r=e.x,n=e.y;return void 0===o&&(o={}),o.x=t.c1r1*r+t.c2r1*n+t.c3r1,o.y=t.c1r2*r+t.c2r2*n+t.c3r2,o}e.copy=function(t,e){return void 0===e&&(e={}),e.c1r1=t.c1r1,e.c2r1=t.c2r1,e.c3r1=t.c3r1,e.c1r2=t.c1r2,e.c2r2=t.c2r2,e.c3r2=t.c3r2,e},e.invert=n,e.determinant=i,e.concat=a,e.pivot=s,e.conjugate=u,e.identity=function(t){return void 0===t&&(t={}),t.c1r1=1,t.c2r1=0,t.c3r1=0,t.c1r2=0,t.c2r2=1,t.c3r2=0,t},e.translate=c,e.scale=f,e.scaleToPoint=function(t,e,o,n){void 0===n&&(n={});var i=r.Vec2.fromPointToPoint(o,t),a=r.Vec2.fromPointToPoint(o,e);return s(f({x:a.x/i.x,y:a.y/i.y},n),o,n)},e.stretch=p,e.rotate=function(t,e){return void 0===e&&(e={}),h(Math.sin(t),Math.cos(t),e)},e.stretchRotateToPoint=function(t,e,o,n){void 0===n&&(n={});var i=r.Vec2.fromPointToPoint(o,t),u=r.Vec2.fromPointToPoint(o,e),c=r.Vec2.length(i),f=r.Vec2.length(u),l=p(f/c),d=r.Vec2.divide(i,c),y=r.Vec2.divide(u,f);return s(a(l,h(r.Vec2.cross(d,y),r.Vec2.dot(d,y))),o,n)},e.sinCos=h,e.rectToRect=function(t,e,o,n){void 0===o&&(o=2),void 0===n&&(n={});var i={x:0,y:0},s=l(t,o),u=l(e,o);c(r.Vec2.fromPointToPoint(s,i),n);var h=e.width/t.width,d=e.height/t.height;return a(2==o?f({x:h,y:d}):p(Math.min(h,d)),n,n),a(c(r.Vec2.fromPointToPoint(i,u)),n,n)},e.mapPoint=d,e.mapRect=function(t,e,o){void 0===o&&(o=r.Rect.empty());var n=d(t,e.topLeft()),i=n.x,a=n.y,s=[e.bottomLeft(),e.bottomRight(),e.topRight()];o.left=o.right=i,o.top=o.bottom=a;for(var u=0,c=s;u<c.length;u++){var f=c[u];o.unionPoint(d(t,f))}return o},e.equals=function(t,e,o){return void 0===o&&(o=0),Math.abs(t.c1r1-e.c1r1)<=o&&Math.abs(t.c1r2-e.c1r2)<=o&&Math.abs(t.c2r1-e.c2r1)<=o&&Math.abs(t.c2r2-e.c2r2)<=o&&Math.abs(t.c3r1-e.c3r1)<=o&&Math.abs(t.c3r2-e.c3r2)<=o}},746:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.ortho=void 0,e.ortho=function(t,e,o,r){var n=t.width,i=t.height,a=e-o;r[0]=2/n,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=2/i,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[10]=1/a,r[11]=0,r[12]=-(t.right+t.left)/n,r[13]=-(t.top+t.bottom)/i,r[14]=-e/a,r[15]=1}},71:(t,e,o)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.equals=e.distance2=e.distance=e.midpoint=e.copy=void 0;var r=o(457);function n(t,e){return r.Vec2.length2(r.Vec2.fromPointToPoint(t,e))}e.copy=function(t,e){return void 0===e&&(e={}),e.x=t.x,e.y=t.y,e},e.midpoint=function(t,e,o){return void 0===o&&(o={}),r.Vec2.multiply(r.Vec2.add(t,e,o),.5,o)},e.distance=function(t,e){return Math.sqrt(n(t,e))},e.distance2=n,e.equals=function(t,e,o){return void 0===o&&(o=0),Math.abs(t.x-e.x)<=o&&Math.abs(t.y-e.y)<=o}},523:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.Rect=void 0;var o=function(){function t(t,e,o,r){this.left=t,this.top=e,this.right=o,this.bottom=r}return t.copy=function(e,o){return void 0===o&&(o=t.empty()),o.left=e.left,o.top=e.top,o.right=e.right,o.bottom=e.bottom,o},t.empty=function(){return new t(0,0,0,0)},t.dimensions=function(e,o,r,n){return new t(e,o,e+r,o-n)},Object.defineProperty(t.prototype,"width",{get:function(){return this.right-this.left},set:function(t){this.right=this.left+t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"height",{get:function(){return this.top-this.bottom},set:function(t){this.bottom=this.top-t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"aspect",{get:function(){return this.width/this.height},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"area",{get:function(){return this.width*this.height},enumerable:!1,configurable:!0}),t.prototype.center=function(t){return void 0===t&&(t={}),t.x=this.centerX,t.y=this.centerY,t},Object.defineProperty(t.prototype,"centerX",{get:function(){return.5*(this.left+this.right)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"centerY",{get:function(){return.5*(this.bottom+this.top)},enumerable:!1,configurable:!0}),t.prototype.topLeft=function(t){return void 0===t&&(t={}),t.x=this.left,t.y=this.top,t},t.prototype.bottomLeft=function(t){return void 0===t&&(t={}),t.x=this.left,t.y=this.bottom,t},t.prototype.bottomRight=function(t){return void 0===t&&(t={}),t.x=this.right,t.y=this.bottom,t},t.prototype.topRight=function(t){return void 0===t&&(t={}),t.x=this.right,t.y=this.top,t},t.prototype.isEmpty=function(){return this.left>=this.right||this.bottom>=this.top},t.prototype.isValid=function(){return this.right>=this.left&&this.top>=this.bottom},t.prototype.union=function(t){this.left=Math.min(this.left,t.left),this.right=Math.max(this.right,t.right),this.bottom=Math.min(this.bottom,t.bottom),this.top=Math.max(this.top,t.top)},t.prototype.unionPoint=function(t){var e=t.x,o=t.y;this.left=Math.min(e,this.left),this.top=Math.max(o,this.top),this.right=Math.max(e,this.right),this.bottom=Math.min(o,this.bottom)},t.prototype.intersects=function(t){return this.right>=t.left&&t.right>=this.left&&this.top>=t.bottom&&t.top>=this.bottom},t.prototype.intersect=function(t){this.left=Math.max(this.left,t.left),this.right=Math.min(this.right,t.right),this.bottom=Math.max(this.bottom,t.bottom),this.top=Math.min(this.top,t.top)},t.prototype.inset=function(t){var e=t.x,o=t.y;this.left+=e,this.top-=o,this.right-=e,this.bottom+=o},t.prototype.offset=function(t){var e=t.x,o=t.y;this.offsetX(e),this.offsetY(o)},t.prototype.offsetX=function(t){this.left+=t,this.right+=t},t.prototype.offsetY=function(t){this.top+=t,this.bottom+=t},t.prototype.scale=function(t){var e=t.x,o=t.y;this.scaleX(e),this.scaleY(o)},t.prototype.scaleX=function(t){var e=this.centerX;this.offsetX(-e),this.left*=t,this.right*=t,this.offsetX(e)},t.prototype.scaleY=function(t){var e=this.centerY;this.offsetY(-e),this.top*=t,this.bottom*=t,this.offsetY(e)},t.prototype.stretch=function(t){this.scaleX(t),this.scaleY(t)},t.prototype.contains=function(t){return this.left<=t.left&&t.right<=this.right&&this.bottom<=t.bottom&&t.top<=this.top},t.prototype.containsPoint=function(t){var e=t.x,o=t.y;return this.containsX(e)&&this.containsY(o)},t.prototype.containsX=function(t){return this.left<=t&&t<=this.right},t.prototype.containsY=function(t){return this.bottom<=t&&t<=this.top},t.prototype.sort=function(){var t=this,e=t.top,o=t.left,r=t.bottom,n=t.right,i=r>e,a=o>n;this.top=i?r:e,this.left=a?n:o,this.bottom=i?e:r,this.right=a?o:n},t.prototype.equals=function(t,e){return void 0===e&&(e=0),Math.abs(this.left-t.left)<=e&&Math.abs(this.top-t.top)<=e&&Math.abs(this.right-t.right)<=e&&Math.abs(this.bottom-t.bottom)<=e},t}();e.Rect=o},768:(t,e)=>{function o(t,e){return Math.floor(Math.random()*(e-t+1))+t}Object.defineProperty(e,"__esModule",{value:!0}),e.randomByte=e.randomInt=e.pad=void 0,e.pad=function(t){return 1==t.length?"0"+t:t},e.randomInt=o,e.randomByte=function(){return o(0,255)}},900:(t,e)=>{function o(t,e,o){return void 0===o&&(o={}),o.x=t.x+e.x,o.y=t.y+e.y,o}function r(t,e,o){var r=t.x,n=t.y;return void 0===o&&(o={}),o.x=r*e,o.y=n*e,o}function n(t,e,o){var r=t.x,n=t.y;return void 0===o&&(o={}),o.x=r/e,o.y=n/e,o}function i(t){return Math.sqrt(a(t))}function a(t){var e=t.x,o=t.y;return e*e+o*o}function s(t,e){return t.x*e.x+t.y*e.y}function u(t,e){return void 0===e&&(e={}),n(t,i(t),e)}function c(t,e){var o=t.x,r=t.y;return void 0===e&&(e={}),e.x=r,e.y=-o,e}function f(t,e,o){var r=t+e,n=t<0?o.left:o.right;return o.containsX(r)?t:n-e}function p(t,e,o){var r=t+e,n=t<0?o.bottom:o.top;return o.containsY(r)?t:n-e}Object.defineProperty(e,"__esModule",{value:!0}),e.equals=e.miter=e.boundY=e.boundX=e.bound=e.fromPointToPoint=e.rotate270=e.rotate180=e.rotate90=e.normalize=e.cross=e.dot=e.length2=e.length=e.divide=e.multiply=e.subtract=e.add=e.copy=void 0,e.copy=function(t,e){return void 0===e&&(e={}),e.x=t.x,e.y=t.y,e},e.add=o,e.subtract=function(t,e,o){return void 0===o&&(o={}),o.x=t.x-e.x,o.y=t.y-e.y,o},e.multiply=r,e.divide=n,e.length=i,e.length2=a,e.dot=s,e.cross=function(t,e){return t.x*e.y-e.x*t.y},e.normalize=u,e.rotate90=c,e.rotate180=function(t,e){var o=t.x,r=t.y;return void 0===e&&(e={}),e.x=-o,e.y=-r,e},e.rotate270=function(t,e){var o=t.x,r=t.y;return void 0===e&&(e={}),e.x=-r,e.y=o,e},e.fromPointToPoint=function(t,e,o){return void 0===o&&(o={}),o.x=e.x-t.x,o.y=e.y-t.y,o},e.bound=function(t,e,o,r){return void 0===r&&(r={}),r.x=f(t.x,e.x,o),r.y=p(t.y,e.y,o),r},e.boundX=f,e.boundY=p,e.miter=function(t,e,n,i,a){void 0===a&&(a={});var f=u(c(t)),p=u(c(e)),h=u(o(f,p));return r(h,Math.min(i,n/s(h,p)),a)},e.equals=function(t,e,o){return void 0===o&&(o=0),Math.abs(t.x-e.x)<=o&&Math.abs(t.y-e.y)<=o}},357:function(t,e,o){var r,n=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)});Object.defineProperty(e,"__esModule",{value:!0}),e.PanTool=void 0;var i=o(457),a=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.wherePointer=function(t){return t.isDown&&1==t.activePointers.length},e.prototype.onPointerDown=function(t){this.previous=t.position},e.prototype.onPointerMove=function(t){var e=t.position,o=t.surface,r=i.Vec2.fromPointToPoint(e,this.previous),n=o.pan(r);i.Vec2.add(n,e,this.previous)},e}(i.PointerEventListener);e.PanTool=a},807:function(t,e,o){var r,n=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)});Object.defineProperty(e,"__esModule",{value:!0}),e.PinchZoomTool=void 0;var i=o(457),a=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.wherePointer=function(t){return t.isDown&&2==t.activePointers.length},e.prototype.onPointerDown=function(t){var e=this.measureLine(t);this.previousSpan=e.length,this.previousFocus=e.midpoint},e.prototype.onPointerMove=function(t){var e=this.measureLine(t),o=e.length/this.previousSpan,r=i.Point.midpoint(e.midpoint,this.previousFocus),n=t.surface.zoomToPoint(o,r);this.previousSpan=e.length/n.scale,this.previousFocus=i.Vec2.add(n.offset,this.previousFocus)},e.prototype.measureLine=function(t){var e=t.activePointers,o=e[0].position,r=e[1].position;return new i.LineSegment(o,r)},e}(i.PointerEventListener);e.PinchZoomTool=a},9:(t,e,o)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.Stroke=void 0;var r=o(457),n=function(){function t(){this.vertices=[]}return t.prototype.moveTo=function(t,e){var o=t.x,r=t.y,n=.5*e,i={x:o,y:r+n},a={x:o,y:r-n};this.vertices.push(i,a)},t.prototype.lineTo=function(t,e){var o=this.vertices.length;if(o<2)throw"Must make a call to moveTo() before making a call to lineTo()";var n=.5*e,i=this.getPreviousPoint(o),a=r.Vec2.fromPointToPoint(i,t),s=null;if(o>=4){var u=this.getPreviousPoint(o-2);s=r.Vec2.fromPointToPoint(u,i),r.Vec2.length(a)<=n&&r.Vec2.length(s)<=n&&(o-=2,i=u,a=r.Vec2.fromPointToPoint(i,t),s=o>=4?this.getPreviousPoint(o-2):null)}var c=r.Vec2.multiply(r.Vec2.normalize(r.Vec2.rotate90(a)),n),f=null!==s&&r.Vec2.length(s)>e/8?r.Vec2.miter(s,a,n,e):c;this.vertices[o-2]=r.Vec2.add(i,f),this.vertices[o-1]=r.Vec2.subtract(i,f),this.vertices[o+0]=r.Vec2.add(t,c),this.vertices[o+1]=r.Vec2.subtract(t,c)},t.prototype.getPreviousPoint=function(t){var e=this.vertices,o=e[t-2],n=e[t-1];return r.Point.midpoint(o,n)},t}();e.Stroke=n},343:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.WheelZoomTool=void 0;var o=function(){function t(t){this.scaleFactor=t}return t.prototype.onWheel=function(t){var e=t.deltaY<0?this.scaleFactor:1/this.scaleFactor;t.surface.zoomToPoint(e,t.position)},t}();e.WheelZoomTool=o},268:(t,e,o)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.createBitArray=e.BinaryImage=e.BitArray=void 0;var r=o(917),n=function(){function t(t){this.data=new Uint8Array(t),this.length=t.byteLength<<3}return t.prototype.get=function(t){var e=t>>3,o=7&t;return this.data[e]>>o&1},t.prototype.set=function(t){var e=t>>3,o=7&t;this.data[e]|=1<<o},t.prototype.clear=function(t){var e=t>>3,o=7&t;this.data[e]&=~(1<<o)},t.prototype.forEach=function(t){for(var e=0;e<this.data.length;e++)for(var o=this.data[e],r=0;r<8;r++)t(o>>r&1)},t.prototype.toString=function(){var t="";return this.forEach((function(e){t+=e})),t},t}();e.BitArray=n;var i=function(){function t(t,e,o){this.data=t,this.color=o,this.bounds=e}return t.make=function(e,o,n,i){for(var s,u=0,c=0;u<n;u++)for(var f=0;f<o;f++)e.get(c++)&&(s?s.unionPoint$(f,u):s=r.Obj.ltrb(f,u,f,u));if(!s)return null;var p=a((r.width(s)+1)*(r.height(s)+1));for(u=s.bottom,c=0;u<=s.top;u++)for(f=s.left;f<=s.right;f++,c++)e.get(u*o+f)&&p.set(c);return new t(p,s,i)},t.prototype.forEachSetBit=function(t,e){var o=this,r=this.bounds.left,n=this.bounds.bottom*t;this.data.forEach((function(i){i&&e(n+r),++r>o.bounds.right&&(r=o.bounds.left,n+=t)}))},t}();function a(t){var e=t>>3;return 7&t&&e++,new n(new ArrayBuffer(e))}e.BinaryImage=i,e.createBitArray=a},917:function(t,e,o){var r,n=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)});Object.defineProperty(e,"__esModule",{value:!0}),e.scale=e.offset=e.inset=e.unionPoints$=e.unionPoints=e.unionPoint$=e.unionPoint=e.union=e.intersect=e.intersects=e.containsPoint$=e.containsPoint=e.contains=e.setUnionOfPoints$=e.setUnionOfPoints=e.empty=e.topRight=e.topLeft=e.bottomRight=e.bottomLeft=e.centerRight=e.centerLeft=e.centerBottom=e.centerTop=e.center=e.centerY=e.centerX=e.area=e.height=e.width=e.isValid=e.isEmpty=e.setLbwh=e.setLtwh=e.setLrbt=e.setLbrt=e.setLtrb=e.toString=e.epsilonEqualsScalar=e.epsilonEquals=e.equalsScalar=e.equals=e.divScalar=e.mulScalar=e.subtract$=e.subtract=e.add$=e.add=e.set$=e.set=void 0,e.Buf=e.Struct=e.Obj=e.sort=e.expandToSquare=e.shrinkToSquare=e.stretch=void 0;var i=o(516),a=o(256);function s(t,e){t.left=e.left,t.top=e.top,t.right=e.right,t.bottom=e.bottom}function u(t,e,o,r,n){t.left=e,t.top=o,t.right=r,t.bottom=n}function c(t,e){t.left+=e.left,t.top+=e.top,t.right+=e.right,t.bottom+=e.bottom}function f(t,e,o,r,n){t.left+=e,t.top+=o,t.right+=r,t.bottom+=n}function p(t,e){t.left-=e.left,t.top-=e.top,t.right-=e.right,t.bottom-=e.bottom}function h(t,e,o,r,n){t.left-=e,t.top-=o,t.right-=r,t.bottom-=n}function l(t,e){t.left*=e,t.top*=e,t.right*=e,t.bottom*=e}function d(t,e){t.left/=e,t.top/=e,t.right/=e,t.bottom/=e}function y(t,e){return t.left===e.left&&t.top===e.top&&t.right===e.right&&t.bottom===e.bottom}function v(t,e){return t.left===e&&t.top===e&&t.right===e&&t.bottom===e}function b(t,e,o){return Math.abs(t.left-e.left)<=o&&Math.abs(t.top-e.top)<=o&&Math.abs(t.right-e.right)<=o&&Math.abs(t.bottom-e.bottom)<=o}function m(t,e,o){return Math.abs(t.left-e)<=o&&Math.abs(t.top-e)<=o&&Math.abs(t.right-e)<=o&&Math.abs(t.bottom-e)<=o}function g(t){return"{ left: "+t.left+", top: "+t.top+", right: "+t.right+", bottom: "+t.bottom+" }"}function P(t,e,o,r,n){t.left=e,t.top=o,t.right=r,t.bottom=n}function x(t,e,o,r,n){t.left=e,t.top=n,t.right=r,t.bottom=o}function _(t,e,o,r,n){t.left=e,t.top=n,t.right=o,t.bottom=r}function A(t,e,o,r,n){t.left=e,t.top=o,t.right=e+r,t.bottom=o-n}function M(t,e,o,r,n){t.left=e,t.top=o+n,t.right=e+r,t.bottom=o}function w(t){return t.left>=t.right||t.bottom>=t.top}function O(t){return t.right>=t.left&&t.top>=t.bottom}function R(t){return t.right-t.left}function L(t){return t.top-t.bottom}function E(t){return R(t)*L(t)}function B(t){return.5*(t.left+t.right)}function T(t){return.5*(t.bottom+t.top)}function S(t,e){return e.x=B(t),e.y=T(t),e}function j(t,e){return e.x=B(t),e.y=t.top,e}function C(t,e){return e.x=B(t),e.y=t.bottom,e}function V(t,e){return e.x=t.left,e.y=T(t),e}function q(t,e){return e.x=t.left,e.y=T(t),e}function I(t,e){return e.x=t.left,e.y=t.bottom,e}function F(t,e){return e.x=t.right,e.y=t.bottom,e}function $(t,e){return e.x=t.left,e.y=t.top,e}function D(t,e){return e.x=t.right,e.y=t.top,e}function U(t){t.left=0,t.top=0,t.right=0,t.bottom=0}function H(t,e,o,r){void 0===o&&(o=0),void 0===r&&(r=e.length),t.left=t.right=e[o].x,t.top=t.bottom=e[o].y,J(t,e,o+1,r-1)}function N(t,e,o,r){void 0===o&&(o=0),void 0===r&&(r=e.length>>1),t.left=t.right=e[o++],t.top=t.bottom=e[o++],Q(t,e,o,r-1)}function Y(t,e){return t.left<=e.left&&e.right<=t.right&&t.bottom<=e.bottom&&e.top<=t.top}function G(t,e){return W(t,e.x,e.y)}function W(t,e,o){return t.left<=e&&e<=t.right&&t.bottom<=o&&o<=t.top}function z(t,e){return t.right>=e.left&&e.right>=t.left&&t.top>=e.bottom&&e.top>=t.bottom}function k(t,e){t.left=Math.max(t.left,e.left),t.right=Math.min(t.right,e.right),t.bottom=Math.max(t.bottom,e.bottom),t.top=Math.min(t.top,e.top)}function X(t,e){t.left=Math.max(t.left,e.left),t.right=Math.min(t.right,e.right),t.bottom=Math.max(t.bottom,e.bottom),t.top=Math.min(t.top,e.top)}function Z(t,e){K(t,e.x,e.y)}function K(t,e,o){t.left=Math.min(e,t.left),t.top=Math.max(o,t.top),t.right=Math.max(e,t.right),t.bottom=Math.min(o,t.bottom)}function J(t,e,o,r){for(void 0===o&&(o=0),void 0===r&&(r=e.length);r-- >0;)Z(t,e[o++])}function Q(t,e,o,r){for(void 0===o&&(o=0),void 0===r&&(r=e.length>>1);r-- >0;)K(t,e[o++],e[o++])}function tt(t,e,o){t.left+=e,t.top-=o,t.right-=e,t.bottom+=o}function et(t,e,o){t.left+=e,t.top+=o,t.right+=e,t.bottom+=o}function ot(t,e,o){var r=B(t),n=T(t);et(t,-r,-n),t.left*=e,t.right*=e,t.bottom*=o,t.top*=o,et(t,r,n)}function rt(t,e){ot(t,e,e)}function nt(t){var e=R(t),o=L(t);o>e?ot(t,1,e/o):e>o&&ot(t,o/e,1)}function it(t){var e=R(t),o=L(t);o>e?ot(t,o/e,1):e>o&&ot(t,1,e/o)}function at(t){if(t.bottom>t.top){var e=t.top;t.top=t.bottom,t.bottom=e}if(t.left>t.right){var o=t.right;t.right=t.left,t.left=o}}e.set=s,e.set$=u,e.add=c,e.add$=f,e.subtract=p,e.subtract$=h,e.mulScalar=l,e.divScalar=d,e.equals=y,e.equalsScalar=v,e.epsilonEquals=b,e.epsilonEqualsScalar=m,e.toString=g,e.setLtrb=P,e.setLbrt=x,e.setLrbt=_,e.setLtwh=A,e.setLbwh=M,e.isEmpty=w,e.isValid=O,e.width=R,e.height=L,e.area=E,e.centerX=B,e.centerY=T,e.center=S,e.centerTop=j,e.centerBottom=C,e.centerLeft=V,e.centerRight=q,e.bottomLeft=I,e.bottomRight=F,e.topLeft=$,e.topRight=D,e.empty=U,e.setUnionOfPoints=H,e.setUnionOfPoints$=N,e.contains=Y,e.containsPoint=G,e.containsPoint$=W,e.intersects=z,e.intersect=k,e.union=X,e.unionPoint=Z,e.unionPoint$=K,e.unionPoints=J,e.unionPoints$=Q,e.inset=tt,e.offset=et,e.scale=ot,e.stretch=rt,e.shrinkToSquare=nt,e.expandToSquare=it,e.sort=at;var st=function(){function t(){}return t.create=function(e){var o=new t;return o.set(e),o},t.create$=function(e,o,r,n){var i=new t;return i.set$(e,o,r,n),i},t.ltrb=function(e,o,r,n){var i=new t;return i.setLtrb(e,o,r,n),i},t.lbrt=function(e,o,r,n){var i=new t;return i.setLbrt(e,o,r,n),i},t.lrbt=function(e,o,r,n){var i=new t;return i.setLrbt(e,o,r,n),i},t.ltwh=function(e,o,r,n){var i=new t;return i.setLtwh(e,o,r,n),i},t.lbwh=function(e,o,r,n){var i=new t;return i.setLbwh(e,o,r,n),i},t.unionOfPoints=function(e,o,r){void 0===o&&(o=0),void 0===r&&(r=e.length);var n=new t;return n.setUnionOfPoints(e,o,r),n},t.unionOfPoints$=function(e,o,r){void 0===o&&(o=0),void 0===r&&(r=e.length>>1);var n=new t;return n.setUnionOfPoints$(e,o,r),n},t.prototype.set=function(t){return s(this,t)},t.prototype.set$=function(t,e,o,r){return u(this,t,e,o,r)},t.prototype.add=function(t){return c(this,t)},t.prototype.add$=function(t,e,o,r){return f(this,t,e,o,r)},t.prototype.subtract=function(t){return p(this,t)},t.prototype.subtract$=function(t,e,o,r){return h(this,t,e,o,r)},t.prototype.mulScalar=function(t){return l(this,t)},t.prototype.divScalar=function(t){return d(this,t)},t.prototype.equals=function(t){return y(this,t)},t.prototype.equalsScalar=function(t){return v(this,t)},t.prototype.epsilonEquals=function(t,e){return b(this,t,e)},t.prototype.epsilonEqualsScalar=function(t,e){return m(this,t,e)},t.prototype.toString=function(){return g(this)},t.prototype.setLtrb=function(t,e,o,r){return P(this,t,e,o,r)},t.prototype.setLbrt=function(t,e,o,r){return x(this,t,e,o,r)},t.prototype.setLrbt=function(t,e,o,r){return _(this,t,e,o,r)},t.prototype.setLtwh=function(t,e,o,r){return A(this,t,e,o,r)},t.prototype.setLbwh=function(t,e,o,r){return M(this,t,e,o,r)},t.prototype.isEmpty=function(){return w(this)},t.prototype.isValid=function(){return O(this)},t.prototype.width=function(){return R(this)},t.prototype.height=function(){return L(this)},t.prototype.area=function(){return E(this)},t.prototype.centerX=function(){return B(this)},t.prototype.centerY=function(){return T(this)},t.prototype.center=function(t){return S(this,t)},t.prototype.centerTop=function(t){return j(this,t)},t.prototype.centerBottom=function(t){return C(this,t)},t.prototype.centerLeft=function(t){return V(this,t)},t.prototype.centerRight=function(t){return q(this,t)},t.prototype.bottomLeft=function(t){return I(this,t)},t.prototype.bottomRight=function(t){return F(this,t)},t.prototype.topLeft=function(t){return $(this,t)},t.prototype.topRight=function(t){return D(this,t)},t.prototype.empty=function(){return U(this)},t.prototype.setUnionOfPoints=function(t,e,o){return void 0===e&&(e=0),void 0===o&&(o=t.length),H(this,t,e,o)},t.prototype.setUnionOfPoints$=function(t,e,o){return void 0===e&&(e=0),void 0===o&&(o=t.length>>1),N(this,t,e,o)},t.prototype.contains=function(t){return Y(this,t)},t.prototype.containsPoint=function(t){return G(this,t)},t.prototype.containsPoint$=function(t,e){return W(this,t,e)},t.prototype.intersects=function(t){return z(this,t)},t.prototype.intersect=function(t){return k(this,t)},t.prototype.union=function(t){return X(this,t)},t.prototype.unionPoint=function(t){return Z(this,t)},t.prototype.unionPoint$=function(t,e){return K(this,t,e)},t.prototype.unionPoints=function(t,e,o){return void 0===e&&(e=0),void 0===o&&(o=t.length),J(this,t,e,o)},t.prototype.unionPoints$=function(t,e,o){return void 0===e&&(e=0),void 0===o&&(o=t.length>>1),Q(this,t,e,o)},t.prototype.inset=function(t,e){return tt(this,t,e)},t.prototype.offset=function(t,e){return et(this,t,e)},t.prototype.scale=function(t,e){return ot(this,t,e)},t.prototype.stretch=function(t){return rt(this,t)},t.prototype.shrinkToSquare=function(){return nt(this)},t.prototype.expandToSquare=function(){return it(this)},t.prototype.sort=function(){return at(this)},t}();e.Obj=st;var ut=function(t){function e(){return t.call(this,new Float32Array(4))||this}return n(e,t),e.create=function(t){var o=new e;return o.set(t),o},e.create$=function(t,o,r,n){var i=new e;return i.set$(t,o,r,n),i},e.ltrb=function(t,o,r,n){var i=new e;return i.setLtrb(t,o,r,n),i},e.lbrt=function(t,o,r,n){var i=new e;return i.setLbrt(t,o,r,n),i},e.lrbt=function(t,o,r,n){var i=new e;return i.setLrbt(t,o,r,n),i},e.ltwh=function(t,o,r,n){var i=new e;return i.setLtwh(t,o,r,n),i},e.lbwh=function(t,o,r,n){var i=new e;return i.setLbwh(t,o,r,n),i},e.unionOfPoints=function(t,o,r){void 0===o&&(o=0),void 0===r&&(r=t.length);var n=new e;return n.setUnionOfPoints(t,o,r),n},e.unionOfPoints$=function(t,o,r){void 0===o&&(o=0),void 0===r&&(r=t.length>>1);var n=new e;return n.setUnionOfPoints$(t,o,r),n},Object.defineProperty(e.prototype,"left",{get:function(){return this.data[0]},set:function(t){this.data[0]=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"top",{get:function(){return this.data[1]},set:function(t){this.data[1]=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"right",{get:function(){return this.data[2]},set:function(t){this.data[2]=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"bottom",{get:function(){return this.data[3]},set:function(t){this.data[3]=t},enumerable:!1,configurable:!0}),e.prototype.set=function(t){return s(this,t)},e.prototype.set$=function(t,e,o,r){return u(this,t,e,o,r)},e.prototype.add=function(t){return c(this,t)},e.prototype.add$=function(t,e,o,r){return f(this,t,e,o,r)},e.prototype.subtract=function(t){return p(this,t)},e.prototype.subtract$=function(t,e,o,r){return h(this,t,e,o,r)},e.prototype.mulScalar=function(t){return l(this,t)},e.prototype.divScalar=function(t){return d(this,t)},e.prototype.equals=function(t){return y(this,t)},e.prototype.equalsScalar=function(t){return v(this,t)},e.prototype.epsilonEquals=function(t,e){return b(this,t,e)},e.prototype.epsilonEqualsScalar=function(t,e){return m(this,t,e)},e.prototype.toString=function(){return g(this)},e.prototype.setLtrb=function(t,e,o,r){return P(this,t,e,o,r)},e.prototype.setLbrt=function(t,e,o,r){return x(this,t,e,o,r)},e.prototype.setLrbt=function(t,e,o,r){return _(this,t,e,o,r)},e.prototype.setLtwh=function(t,e,o,r){return A(this,t,e,o,r)},e.prototype.setLbwh=function(t,e,o,r){return M(this,t,e,o,r)},e.prototype.isEmpty=function(){return w(this)},e.prototype.isValid=function(){return O(this)},e.prototype.width=function(){return R(this)},e.prototype.height=function(){return L(this)},e.prototype.area=function(){return E(this)},e.prototype.centerX=function(){return B(this)},e.prototype.centerY=function(){return T(this)},e.prototype.center=function(t){return S(this,t)},e.prototype.centerTop=function(t){return j(this,t)},e.prototype.centerBottom=function(t){return C(this,t)},e.prototype.centerLeft=function(t){return V(this,t)},e.prototype.centerRight=function(t){return q(this,t)},e.prototype.bottomLeft=function(t){return I(this,t)},e.prototype.bottomRight=function(t){return F(this,t)},e.prototype.topLeft=function(t){return $(this,t)},e.prototype.topRight=function(t){return D(this,t)},e.prototype.empty=function(){return U(this)},e.prototype.setUnionOfPoints=function(t,e,o){return void 0===e&&(e=0),void 0===o&&(o=t.length),H(this,t,e,o)},e.prototype.setUnionOfPoints$=function(t,e,o){return void 0===e&&(e=0),void 0===o&&(o=t.length>>1),N(this,t,e,o)},e.prototype.contains=function(t){return Y(this,t)},e.prototype.containsPoint=function(t){return G(this,t)},e.prototype.containsPoint$=function(t,e){return W(this,t,e)},e.prototype.intersects=function(t){return z(this,t)},e.prototype.intersect=function(t){return k(this,t)},e.prototype.union=function(t){return X(this,t)},e.prototype.unionPoint=function(t){return Z(this,t)},e.prototype.unionPoint$=function(t,e){return K(this,t,e)},e.prototype.unionPoints=function(t,e,o){return void 0===e&&(e=0),void 0===o&&(o=t.length),J(this,t,e,o)},e.prototype.unionPoints$=function(t,e,o){return void 0===e&&(e=0),void 0===o&&(o=t.length>>1),Q(this,t,e,o)},e.prototype.inset=function(t,e){return tt(this,t,e)},e.prototype.offset=function(t,e){return et(this,t,e)},e.prototype.scale=function(t,e){return ot(this,t,e)},e.prototype.stretch=function(t){return rt(this,t)},e.prototype.shrinkToSquare=function(){return nt(this)},e.prototype.expandToSquare=function(){return it(this)},e.prototype.sort=function(){return at(this)},e}(i.default);e.Struct=ut;var ct=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.create=function(t){return new e(new Float32Array(4*t))},Object.defineProperty(e.prototype,"left",{get:function(){return this.data[this.dataPosition+0]},set:function(t){this.data[this.dataPosition+0]=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"top",{get:function(){return this.data[this.dataPosition+1]},set:function(t){this.data[this.dataPosition+1]=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"right",{get:function(){return this.data[this.dataPosition+2]},set:function(t){this.data[this.dataPosition+2]=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"bottom",{get:function(){return this.data[this.dataPosition+3]},set:function(t){this.data[this.dataPosition+3]=t},enumerable:!1,configurable:!0}),e.prototype.structLength=function(){return 4},e.prototype.set$=function(t,e,o,r,n){var i=t*this.structLength();this.data[i++]=e,this.data[i++]=o,this.data[i++]=r,this.data[i++]=n},e.prototype.put$=function(t,e,o,r){this.data[this.dataPosition++]=t,this.data[this.dataPosition++]=e,this.data[this.dataPosition++]=o,this.data[this.dataPosition++]=r},e.prototype.$set=function(t){return s(this,t)},e.prototype.$set$=function(t,e,o,r){return u(this,t,e,o,r)},e.prototype.$add=function(t){return c(this,t)},e.prototype.$add$=function(t,e,o,r){return f(this,t,e,o,r)},e.prototype.$subtract=function(t){return p(this,t)},e.prototype.$subtract$=function(t,e,o,r){return h(this,t,e,o,r)},e.prototype.$mulScalar=function(t){return l(this,t)},e.prototype.$divScalar=function(t){return d(this,t)},e.prototype.$equals=function(t){return y(this,t)},e.prototype.$equalsScalar=function(t){return v(this,t)},e.prototype.$epsilonEquals=function(t,e){return b(this,t,e)},e.prototype.$epsilonEqualsScalar=function(t,e){return m(this,t,e)},e.prototype.$toString=function(){return g(this)},e.prototype.$setLtrb=function(t,e,o,r){return P(this,t,e,o,r)},e.prototype.$setLbrt=function(t,e,o,r){return x(this,t,e,o,r)},e.prototype.$setLrbt=function(t,e,o,r){return _(this,t,e,o,r)},e.prototype.$setLtwh=function(t,e,o,r){return A(this,t,e,o,r)},e.prototype.$setLbwh=function(t,e,o,r){return M(this,t,e,o,r)},e.prototype.$isEmpty=function(){return w(this)},e.prototype.$isValid=function(){return O(this)},e.prototype.$width=function(){return R(this)},e.prototype.$height=function(){return L(this)},e.prototype.$area=function(){return E(this)},e.prototype.$centerX=function(){return B(this)},e.prototype.$centerY=function(){return T(this)},e.prototype.$center=function(t){return S(this,t)},e.prototype.$centerTop=function(t){return j(this,t)},e.prototype.$centerBottom=function(t){return C(this,t)},e.prototype.$centerLeft=function(t){return V(this,t)},e.prototype.$centerRight=function(t){return q(this,t)},e.prototype.$bottomLeft=function(t){return I(this,t)},e.prototype.$bottomRight=function(t){return F(this,t)},e.prototype.$topLeft=function(t){return $(this,t)},e.prototype.$topRight=function(t){return D(this,t)},e.prototype.$empty=function(){return U(this)},e.prototype.$setUnionOfPoints=function(t,e,o){return H(this,t,e,o)},e.prototype.$setUnionOfPoints$=function(t,e,o){return N(this,t,e,o)},e.prototype.$contains=function(t){return Y(this,t)},e.prototype.$containsPoint=function(t){return G(this,t)},e.prototype.$containsPoint$=function(t,e){return W(this,t,e)},e.prototype.$intersects=function(t){return z(this,t)},e.prototype.$intersect=function(t){return k(this,t)},e.prototype.$union=function(t){return X(this,t)},e.prototype.$unionPoint=function(t){return Z(this,t)},e.prototype.$unionPoint$=function(t,e){return K(this,t,e)},e.prototype.$unionPoints=function(t,e,o){return J(this,t,e,o)},e.prototype.$unionPoints$=function(t,e,o){return Q(this,t,e,o)},e.prototype.$inset=function(t,e){return tt(this,t,e)},e.prototype.$offset=function(t,e){return et(this,t,e)},e.prototype.$scale=function(t,e){return ot(this,t,e)},e.prototype.$stretch=function(t){return rt(this,t)},e.prototype.$shrinkToSquare=function(){return nt(this)},e.prototype.$expandToSquare=function(){return it(this)},e.prototype.$sort=function(){return at(this)},e}(a.default);e.Buf=ct},256:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0});var o=function(){function t(t,e){void 0===e&&(e=0),this.data=t,this.dataPosition=e*this.structLength()}return t.prototype.position=function(){return this.dataPosition/this.structLength()>>0},t.prototype.capacity=function(){return this.data.length/this.structLength()>>0},t.prototype.hasValidPosition=function(){return 0<=this.dataPosition&&this.dataPosition<this.data.length},t.prototype.moveToPosition=function(t){return this.dataPosition=t*this.structLength(),this.hasValidPosition()},t.prototype.moveToFirst=function(){return this.dataPosition=0,this.dataPosition<this.data.length},t.prototype.moveToNext=function(){return this.dataPosition+=this.structLength(),this.hasValidPosition()},t.prototype.moveToPrevous=function(){return this.dataPosition-=this.structLength(),this.hasValidPosition()},t.prototype.moveToLast=function(){return this.data.length?(this.dataPosition=this.data.length-this.structLength(),!0):(this.dataPosition=0,!1)},t.prototype.setBuffer=function(t,e,o){for(var r=e.dataPosition,n=t*this.structLength();o--;)for(var i=this.structLength();i--;)this.data[n++]=e.data[r++]},t.prototype.set=function(t,e){for(var o=this.structLength(),r=0,n=t*o;o--;)this.data[n++]=e.data[r++]},t.prototype.setEach=function(t){for(var e=0,o=this.data.length;o--;)for(var r=0,n=this.structLength();n--;)this.data[e++]=t.data[r++]},t.prototype.put=function(t){for(var e=this.structLength(),o=0;e--;)this.data[this.dataPosition++]=t.data[o++]},t.prototype.putBuffer=function(t,e){for(void 0===e&&(e=t.capacity()-t.position());e--;)for(var o=this.structLength();o--;)this.data[this.dataPosition++]=t.data[t.dataPosition++]},t.prototype.equals=function(t){if(this.data.length!==t.data.length)return!1;for(var e=0;e<this.data.length;e++)if(this.data[e]!==t.data[e])return!1;return!0},t.prototype.equalsScalar=function(t){for(var e=0;e<this.data.length;e++)if(this.data[e]!==t)return!1;return!0},t.prototype.epsilonEquals=function(t,e){if(this.data.length!==t.data.length)return!1;for(var o=0;o<this.data.length;o++)if(Math.abs(this.data[o]-t.data[o])>e)return!1;return!0},t.prototype.epsilonEqualsScalar=function(t,e,o){for(var r=0;r<this.data.length;r++)if(Math.abs(this.data[r]-e)>o)return!1;return!0},t}();e.default=o},516:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0});e.default=function(t){this.data=t}},278:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.Directions=e.Cube=void 0;var o=function(){function t(t,e,o){void 0===t&&(t=0),void 0===e&&(e=0),void 0===o&&(o=0),this.q=t,this.r=e,this.s=o}return t.distance=function(t,e){return Math.max(Math.abs(t.q-e.q),Math.abs(t.r-e.r),Math.abs(t.s-e.s))},t.create=function(e,o,r){return void 0===e&&(e=0),void 0===o&&(o=0),void 0===r&&(r=new t),r.q=e,r.r=o,r.s=-e-o,r},t.prototype.getNeighbor=function(o,r){return void 0===r&&(r=new t),this.add(e.Directions[o],r)},t.prototype.getDirection=function(t){for(var o=t.subtract(this),r=0;r<e.Directions.length;r++)if(e.Directions[r].equals(o))return r;return-1},t.prototype.add=function(t,e){return void 0===e&&(e=this),e.q=this.q+t.q,e.r=this.r+t.r,e.s=this.s+t.s,e},t.prototype.subtract=function(t,e){return void 0===e&&(e=this),e.q=this.q-t.q,e.r=this.r-t.r,e.s=this.s-t.s,e},t.prototype.scale=function(t,e){return void 0===e&&(e=this),e.q=this.q*t,e.r=this.r*t,e.s=this.s*t,e},t.prototype.round=function(t){void 0===t&&(t=this);var e=this.q,o=this.r,r=this.s;t.q=Math.round(e),t.r=Math.round(o),t.s=Math.round(r);var n=Math.abs(t.q-e),i=Math.abs(t.r-o),a=Math.abs(t.s-r);return n>i&&n>a?t.q=-t.r-t.s:i>a?t.r=-t.q-t.s:t.s=-t.q-t.r,t},t.prototype.equals=function(t){return this.q===t.q&&this.r===t.r&&this.s===t.s},t}();e.Cube=o,e.Directions=[new o(1,-1,0),new o(1,0,-1),new o(0,1,-1),new o(-1,1,0),new o(-1,0,1),new o(0,-1,1)]},57:(t,e,o)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.copyHexelsToCanvas=e.copyPixelsToGrid=e.HexelGrid=e.H_UP=e.H_RIGHT=e.H_HEIGHT=e.H_WIDTH=void 0;var r=o(278),n=o(268),i=o(457);e.H_WIDTH=Math.sqrt(3),e.H_HEIGHT=2,e.H_RIGHT=e.H_WIDTH/2,e.H_UP=e.H_HEIGHT/4;var a=function(){function t(t,o,r){void 0===r&&(r=new i.ColorBuffer(new Uint8ClampedArray(4*t*o))),this.hasGradient=!0,this.cols=t,this.rows=o,this.hexels=r;var n=e.H_WIDTH*(t+.5),a=e.H_HEIGHT*(.75*o+.25),s=-e.H_WIDTH/2,u=a+e.H_HEIGHT/2;this.bounds=i.Rect.dimensions(s,u,n,a)}return t.prototype.cubeAtIndex=function(t,e){void 0===e&&(e=new r.Cube);var o=t/this.cols>>0,n=t%this.cols-(o>>1);return r.Cube.create(n,o,e)},t.prototype.pointAtIndex=function(t,e,o){return void 0===e&&(e={}),void 0===o&&(o=new r.Cube),this.pointAtCube(this.cubeAtIndex(t,o),e)},t.prototype.indexAtPoint=function(t){var e=this.cubeAtPoint(t).round();return this.indexAtCube(e)},t.prototype.indexAtCube=function(t){if(0<=t.r&&t.r<this.rows){var e=t.r>>1;if(-e<=t.q&&t.q<this.cols-e)return this.cols*t.r+t.q+e}return-1},t.prototype.pointAtCube=function(t,o){return void 0===o&&(o={}),o.x=e.H_WIDTH*(t.q+t.r/2),o.y=e.H_HEIGHT*(.75*t.r),o.y=this.bounds.height-o.y,o},t.prototype.cubeAtPoint=function(t,o){void 0===o&&(o=new r.Cube);var n=t.x,i=this.bounds.height-t.y,a=(e.H_WIDTH*n-i)/3,s=e.H_HEIGHT*i/3;return r.Cube.create(a,s,o)},t.prototype.points=function(){for(var t=new r.Cube,e=i.Vec2Buffer.withLength(this.hexels.length),o=0;o<this.hexels.length;o++)this.pointAtIndex(o,e.at(o),t);return e},t.prototype.forEachCubicCoordinate=function(t){for(var e=0;e<this.rows;e++)for(var o=e>>1,n=-o;n<this.cols-o;n++)t(new r.Cube(n,e))},t.prototype.forEachOffsetCoordinate=function(t){for(var e=0;e<this.rows;e++)for(var o=0;o<this.cols;o++)t({x:o,y:e})},t.prototype.clear=function(t){for(var e=0;e<this.hexels.length;e++)i.Color.copy(t,this.hexels.at(e))},t.prototype.addBinaryImage=function(t){},t.prototype.addLine=function(t,e,o,r){void 0===r&&(r=this.bitArray())},t.prototype.addEllipse=function(t,e,o){void 0===o&&(o=this.bitArray())},t.prototype.addShape=function(t,e,o){void 0===o&&(o=this.bitArray())},t.prototype.beginStroke=function(t,e,o,r){void 0===r&&(r=this.bitArray())},t.prototype.continueStroke=function(t,e,o,r,n){var i=this;void 0===n&&(n=this.bitArray());var a=t;return this.forEachCubeInLine(t,e,(function(t){i.appendHexagon(a,t,o,r,n),a=t})),n},t.prototype.appendHexagon=function(t,e,o,r,n){void 0===n&&(n=this.bitArray())},t.prototype.forEachHexelInRange=function(t,e,o){for(var n=new r.Cube,i=-e;i<=e;i++){var a=Math.max(-e,-i-e),s=Math.min(e,-i+e);n.q=t.q+i;for(var u=a;u<=s;u++){n.r=t.r+u;var c=this.indexAtCube(n);-1!==c&&o(c)}}},t.prototype.forEachHexelInRing=function(t,e,o){if(0===e)-1!==(s=this.indexAtCube(t))&&o(s);else{var n=new r.Cube;n.add(r.Directions[4]),n.scale(e),n.add(t);for(var i=0;i<6;i++)for(var a=0;a<e;a++){var s;-1!==(s=this.indexAtCube(n))&&o(s),n.getNeighbor(i,n)}}},t.prototype.forEachCubeInLine=function(t,e,o){for(var n=new r.Cube(e.q-t.q,e.r-t.r),i=r.Cube.distance(n,new r.Cube),a=1/Math.max(i,1),s=0;s<=i;s++){var u=a*s,c=new r.Cube;c.q=t.q+n.q*u,c.r=t.r+n.r*u,c.s=t.s+n.s*u,o(c.round())}},t.prototype.floodFill=function(t,e,o){void 0===o&&(o=this.bitArray())},t.prototype.floodFillScanLine=function(t,e,o,r){void 0===r&&(r=this.bitArray())},t.prototype.bitArray=function(){return n.createBitArray(this.hexels.length)},t}();e.HexelGrid=a,e.copyPixelsToGrid=function(t,e){for(var o=e.cols,r=e.rows,n=e.hexels,a=t.getImageData(0,0,o,r).data,s=new i.ColorBuffer(a),u=Math.min(s.length,n.length),c=0;c<u;c++){var f=s.at(c),p=n.at(c);i.Color.isTransparent(f)||i.Color.blend(f,p,p)}},e.copyHexelsToCanvas=function(t,e,o,r){for(var n=t.cols,a=t.rows,s=t.hexels,u=new i.ColorBuffer(new Uint8ClampedArray(s.data.length)),c=0;c<s.length;c++){var f=u.at(c),p=s.at(c);i.Color.equals(p,e)||i.Color.copy(p,f)}var h=new ImageData(u.data,n,a);r.clearRect(0,0,o.width,o.height),r.putImageData(h,0,0)}},994:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.Scene=void 0;var o=function(){function t(t){this.hexel=t}return t.prototype.draw=function(t){var e=t.gl;e.clearColor(0,0,0,0),e.clear(e.COLOR_BUFFER_BIT),e.enable(e.CULL_FACE),e.cullFace(e.BACK),e.blendFunc(e.SRC_ALPHA,e.ONE_MINUS_SRC_ALPHA),this.hexel.draw(t)},t}();e.Scene=o},432:(t,e,o)=>{var r=o(457),n=o(57),i=o(994),a=o(372),s=document.getElementById("onscreen-canvas"),u=s.getContext("webgl"),c=new r.ProgramUtil(u),f=new n.HexelGrid(128,128);f.clear(r.Color.fromRgbInt(13487565));var p=r.PolygonMesh.regularPolygon(6),h=a.HexelProgram.create(c,p);h.setGrid(u,f);var l=new r.Camera(f.bounds,1,Math.max(f.rows,f.cols)),d=new r.Renderer(u,l),y=new i.Scene(h),v=new r.Surface(s,d,y);v.startRenderLoop(),v.startDetectingWheelEvents().addListener(new r.WheelZoomTool(1.1));var b=v.startDetectingPointerEvents();b.addListener(new r.PanTool),b.addListener(new r.PinchZoomTool)},372:function(t,e,o){var r,n=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)});Object.defineProperty(e,"__esModule",{value:!0}),e.HexelProgram=void 0;var i=o(457),a=o(95),s=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.create=function(t,o){var r=new e;return r.hex=o,r.location=t.createProgramFromSources(a.vertex,a.fragment),r.uniforms=t.getUniformLocationMap(r.location,a.uniformRenaming),r.attribs=t.getAttributeLocationMap(r.location,a.attributeRenaming),r.indexBuffer=t.createIndexBuffer([o]),r.positionBuffer=t.createVertexBuffer([o]),r.offsetBuffer=t.createBuffer(),r.colorBuffer=t.createBuffer(),r.gradientBuffer=t.createArrayBuffer(this.getGradient()),r},e.getGradient=function(){var t=18/256,e=50/256;return new Float32Array([t,.125,e,-t,-.125,-e])},e.prototype.setGrid=function(t,e){this.grid=e,t.bindBuffer(t.ARRAY_BUFFER,this.colorBuffer),t.bufferData(t.ARRAY_BUFFER,e.hexels.data,t.DYNAMIC_DRAW),t.bindBuffer(t.ARRAY_BUFFER,this.offsetBuffer),t.bufferData(t.ARRAY_BUFFER,e.points().data,t.STATIC_DRAW)},e.prototype.onAttach=function(t){this.enableIndexBuffer(t),this.enablePositionBuffer(t),this.enableOffsetBuffer(t),this.enableColorBuffer(t),this.enableGradientBuffer(t)},e.prototype.enableIndexBuffer=function(t){var e=t.gl;e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,this.indexBuffer)},e.prototype.enablePositionBuffer=function(t){var e=t.gl;e.bindBuffer(e.ARRAY_BUFFER,this.positionBuffer),e.enableVertexAttribArray(this.attribs.position),e.vertexAttribPointer(this.attribs.position,2,e.FLOAT,!1,0,this.hex.vertexBufferOffset)},e.prototype.enableOffsetBuffer=function(t){var e=t.gl,o=t.angleExt;e.bindBuffer(e.ARRAY_BUFFER,this.offsetBuffer),e.enableVertexAttribArray(this.attribs.offset),e.vertexAttribPointer(this.attribs.offset,2,e.FLOAT,!1,0,0),o.vertexAttribDivisorANGLE(this.attribs.offset,1)},e.prototype.enableColorBuffer=function(t){var e=t.gl,o=t.angleExt;e.bindBuffer(e.ARRAY_BUFFER,this.colorBuffer),e.enableVertexAttribArray(this.attribs.hexelColor),e.vertexAttribPointer(this.attribs.hexelColor,4,e.UNSIGNED_BYTE,!0,0,0),o.vertexAttribDivisorANGLE(this.attribs.hexelColor,1)},e.prototype.enableGradientBuffer=function(t){var e=t.gl;e.bindBuffer(e.ARRAY_BUFFER,this.gradientBuffer),e.enableVertexAttribArray(this.attribs.gradient),e.vertexAttribPointer(this.attribs.gradient,1,e.FLOAT,!1,0,0)},e.prototype.onDetach=function(t){var e=t.angleExt;e.vertexAttribDivisorANGLE(this.attribs.offset,0),e.vertexAttribDivisorANGLE(this.attribs.color,0)},e.prototype.draw=function(t){var e=t.gl,o=t.angleExt;t.useProgram(this),this.loadProjection(e,t.camera.matrix),o.drawElementsInstancedANGLE(e.TRIANGLES,this.hex.indices.length,e.UNSIGNED_SHORT,this.hex.indexBufferOffset,this.grid.hexels.length)},e.prototype.loadProjection=function(t,e){t.uniformMatrix4fv(this.uniforms.projection,!1,e)},e}(i.Program);e.HexelProgram=s},95:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.uniformRenaming=e.attributeRenaming=e.fragment=e.vertex=void 0,e.vertex="precision mediump float;uniform mat4 c;attribute vec4 d;attribute vec2 e,f;attribute float b;varying vec4 a;void main(){gl_Position=c*vec4(e+f,1.,1.),a=d,a.r+=b,a.g+=b,a.b+=b,a.a=1.;}",e.fragment="precision mediump float;varying vec4 a;void main(){gl_FragColor=a;}",e.attributeRenaming={hexelColor:"d",position:"e",offset:"f",gradient:"b"},e.uniformRenaming={projection:"c"}}},e={};!function o(r){if(e[r])return e[r].exports;var n=e[r]={exports:{}};return t[r].call(n.exports,n,n.exports,o),n.exports}(432)})();
//# sourceMappingURL=index.js.map